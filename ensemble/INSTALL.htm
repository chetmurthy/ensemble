<!doctype html public "-//w3c//dtd html 4.0 transitional//en">
<html>
<head>
   <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
   <meta name="GENERATOR" content="Mozilla/4.72 [en] (X11; U; SunOS 5.6 sun4m) [Netscape]">
   <title>Ensemble Installation Instructions
</title>
</head>
<body text="#000000" bgcolor="#FFFFFF">

<center>
<h1>
Ensemble 0.70p1 - Patch Release 1</h1></center>

<center>
<h2>
Release Notes and Installation Instructions</h2></center>

<center>Copyright &copy; 1997 Cornell University, Ithaca, NY, USA
<br>All rights reserved.</center>

<p><i>Last Revised</i>: Tues May 2, 15:33:48 EDT 2000
<br><i>Maintainers</i>:
<a href="mailto:hayden@pa.dec.com">Mark Hayden</a>,
<a href="mailto:tclark@cs.cornell.edu">Tim
Clark,
</a><a href="mailto:orodeh@cs.huji.ac.il">Ohad Rodeh</a>.&nbsp;
<hr><a NAME="intro"></a>
<h2>
Introduction</h2>
Thank you for choosing Ensemble as your message transport system. Its platform
independence allows you to interconnect a wide range of computing environments.
<p>The following instructions guide you through the process of installing
Ensemble. Click on the hypertext links for the details about each step.
The installation instructions are designed to be as simple as possible.
However, please read them through carefully before starting and follow
them carefully.&nbsp; Also, please read the file <b>RELEASE_NOTES</b> for
the latest information on this release.
<p>These installation instructions are aimed at getting Ensemble up and
running on your system as quickly as possible. After successfully installing
the system, you may wish to compile Ensemble for native instruction set
of your computer and to use an optimized C library we provide in order
to improve performance. The difference is only significant when Ensemble
is used in high-performance settings and many users find the performance
of bytecode satisfactory.
<p>
<hr><a NAME="software"></a>
<h2>
Required Software</h2>

<h1>
<font size=+1>To compile Ensemble you will need either <b><i>version 2.04 </i></b>or
<b><i>version 3.00 </i></b> of the Objective Caml (O'Caml) compiler.</font></h1>
O'Caml is freely available via the World Wide Web at <b><a href="http://pauillac.inria.fr/ocaml">http://pauillac.inria.fr/ocaml</a></b>
Please ensure you have the correct version. See the instructions below
on how to obtain it. This is a different compiler version than required
by previous versions of Ensemble! Version 0.40 of Ensemble used ocaml-1.05,
Version 0.50 of Ensemble used ocaml-1.07, version 0.60 used ocaml-2.01,
and we are now up to ocaml-3.00.
<p>On Unix platforms, to compile the HOT C interface, you need a POSIX
compliant threads package. (On Solaris, you can use the native threads
library).&nbsp; More recent versions of Linux now provide a POSIX compliant
pthreads package (pthreads), however, Linux users with older versions of
the operating system, or users who still use SunOS, will need to acquire
a threads package, such as the FSU threads package or the rvr_threads package.&nbsp;
Click <a href="#fsu-threads">here</a> for information on how to acquire
and install the FSU pthreads package.&nbsp; The rvr_threads package will
be available from Cornell in a separate tar file of contributed code.
<p>To compile the <a href="http://www.cs.cornell.edu/Info/Projects/Ensemble/Maestro/Maestro.html">Maestro</a>
tools C++ interface, you will need a C++ compiler. We use the Microsoft
C++ compiler on Windows NT and gcc on Unix platforms, but other compilers
should work.&nbsp; On NT to build the optimized versions of HOT C and Maestro,
you will also need the masm (MS Compatibility Driver) and ml (MS Macro
Assembler) executables installed and located in your path.
<p>
<hr><a NAME="upgrading"></a>
<h2>
Upgrade Information</h2>
If you are upgrading from an older version, due to problems with long environment
variable names on certain platforms, we have changed the names for the
Ensemble environment variables to use the prefix 'ENS_' instead of 'ENSEMBLE_'.
Please update your configuration.
<p>The name of the group membership service has been changed from 'domain'
to 'groupd'. The names of the corresponding environment variables have
changed from 'ENS_DOMAIN_' to 'ENS_GROUPD_' , as shown above.
<p>After you have made these changes, to upgrade your system simply install
the new version of Ensemble as described below. For further information
on the changes in this release, please read the RELEASE_NOTES found in
the ensemble directory.
<p>Some environment variables will need to be set before running Ensemble
applications which need to communicate with other processes (via the gossip
or groupd servers) - see ensemble/doc/tut.ps for more information:
<p><b>ENSROOT </b>(set to root directory of ensemble distribution, e.g:
/usr/u/ensemble)
<p><b>ENS_ID </b>(set to your user login id)
<p><b>ENS_PORT </b>(for all Ensemble applications, set to an unused port
number)
<p><b>ENS_GOSSIP_PORT, ENS_GOSSIP_HOSTS</b> (for gossip applications, an
unused port number and a list of colon-separated host names, e.g.: mymachine1:mymachine2:mymachine3)
<p><b>ENS_GROUPD_PORT, ENS_GROUPD_HOSTS</b> (for groupd applications, an
unused port number and a list of colon-separated host names)
<p><b>ENS_DEERING_PORT </b>(for IP Multicast, an unused port number)
<p><b>ENS_OUTBOARD </b>(if you will be using the HOT outboard application,
a full pathway to the outboard executable, e.g: /usr/u/ensemble/demo/outboard)
<p>
<hr><a NAME="licensing"></a>
<h2>
Licensing</h2>
Ensemble code is copyrighted by Cornell University. To use Ensemble you
must agree to the terms of the license. Ensemble is freely available software,
but you must agree to the terms of the license before you can install it.
We ask that you read the licensing agreement before installing Ensemble.&nbsp;
It can be found in <b>ensemble/LICENSE</b>.
<p>
<hr><a NAME="installation"></a>
<h2>
Installation</h2>
Install Ensemble by following the step-by-step instructions. You need to
get the O'Caml compiler, extract the Ensemble software, and then compile
the portions you wish to use.
<ul>
<li>
Make sure you have <a href="#ocaml">Objective Caml version 2.04</a> or
<a href="#ocaml">Objective Caml version 3.00</a> installed.</li>

<li>
Set the <b>CAMLLIB</b> environment variable, and put the path to the Ocaml
binaries in your PATH.</li>

<li>
Download and extract the <a href="#download">Ensemble</a> software.</li>

<li>
Click on the operating system link below to obtain the rest of the installation
instructions.</li>

<ul>
<li>
<a href="#winnt-install">Windows NT</a></li>

<li>
<a href="#unix-install">Unix and Unix-like systems</a></li>
</ul>
</ul>
In addition, instructions for building Ensemble on <a href="#multiple-platforms">multiple
platforms</a>.
<p>
<hr><a NAME="ocaml"></a>
<h2>
How to obtain Objective Caml 2.04/3.00</h2>
To compile Ensemble you need Objective Caml version 2.04 or 3.00. <b>Other versions
of the compiler may NOT work.</b> This is because the O'Caml bytecode format
and libraries are not guaranteed to be compatible across versions.
<p>If you already have O'Caml you can check which version you have by typing:
<pre>&nbsp;&nbsp;&nbsp;&nbsp; ocamlc -v</pre>
This gives you the version of the compiler in your path (if there is one).
The first line of the output should be:
<pre>&nbsp;&nbsp;&nbsp;&nbsp; The Objective Caml compiler, version ocaml 2.04</pre>
or <pre>&nbsp;&nbsp;&nbsp;&nbsp; The Objective Caml compiler, version ocaml 3.00</pre>
If you have some other version, then first obtain version 2.04 or 3.00 and install it.
O'Caml is freely available from <a href="http://pauillac.inria.fr/ocaml">http://pauillac.inria.fr/ocaml</a>
and is easy to install (precompiled binaries are available for Windows
NT). You do not need the native code compiler, although you can compile
Ensemble with it.
<h3>
The O'Caml Tcl/Tk Interface</h3>
If you want to compile the white board demo or wish to use the O'Caml Tcl/Tk
interface, you will also need the Ocamltk library. This library is entirely
optional. You can install Ensemble without it and install it later if you
change your mind. The library can be obtained from the O'Caml Web site,
under the distrib directory:
<p><a href="http://pauillac.inria.fr/ocaml/distrib.html">http://pauillac.inria.fr/ocaml/distrib</a>
<p>In order to build the whiteboard demo (wbml) in the demo/tk directory,
you will have to make sure that the camltk41 libraries are installed into
the CAMLLIB directory.&nbsp; You may also need to modify the mk/config.mk
file to add the path to the Tcl/Tk libraries (TKLIBS).
<p><a href="#installation">Back to installation guide.</a>
<hr>
<p><a NAME="download"></a>
<h2>
How to download and extract the Ensemble software</h2>
Download Ensemble from <a href="http://www.cs.cornell.edu/Info/Projects/Ensemble/ftp.html">http://www.cs.cornell.edu/Info/Projects/Ensemble/ftp.html</a>.&nbsp;
Ensemble is no longer encrypted.&nbsp; Simply unzip and untar the distribution.
It will put the sources in a directory called "ensemble". On Windows NT
you can use the winzip program. On Unix platforms, do it this way:
<pre>&nbsp;&nbsp;&nbsp;&nbsp; # uncompress and untar the distribution
&nbsp;&nbsp;&nbsp;&nbsp; gunzip ensemble-0_70p1.tar.gz
&nbsp;&nbsp;&nbsp;&nbsp; tar xvf ensemble.tar</pre>
<a href="#installation">Back to installation guide.</a>
<hr><a NAME="winnt-install"></a>
<h2>
Building Ensemble for Windows NT</h2>
<b>** NOTE ** </b>This distribution of Ensemble requires users to build
the bytecode libraries - they are not supplied pre-compiled as with previous
distributions. Directions to do so are included below. Some demonstration
applications have been provided which you can use to test the distribution
once the first parts are installed.
<p>You can also compile everything to run on the native instruction set
of your computer instead of using an interpreter. This will run faster.
<p><a NAME="winnt-demo"></a>
<h3>
Building on Windows NT</h3>
In the configuration file, <b>ensemble\mk\config.nmk</b>, you may need
to edit the following macro definitions (you may wish to try the default
settings first). <b>MSDEV
</b>and <b>LIBSYS</b> should have appropriate
values for your C compiler. Set the <b>CAMLLIB</b> environment variable
to be the directory where you installed the O'Caml libraries (this is used
to set the OCAML_LIB macro. CAMLLIB should have been set when O'Caml was
installed -- see the O'Caml README.win32 file).&nbsp; However, note that
this environment variable must be set (via Control Panel, System, Environment)
before the DOS console on which you will compile Ensemble is opened.
<p>Compile the bytecode and demonstration programs as follows. Note that
on Windows NT, you need to use <b>nmake </b>and the <b>Makefile.nt </b>versions
of the makefiles:
<pre>&nbsp;&nbsp;&nbsp;&nbsp; # build bytecode ensemble
&nbsp;&nbsp;&nbsp;&nbsp; # directory: ensemble\def
&nbsp;&nbsp;&nbsp;&nbsp; nmake -f Makefile.nt</pre>

<ul>
<pre># build ensemble demos
# directory: ensemble\demo
nmake -f Makefile.nt</pre>
</ul>
If all went smoothly, the initial installation is now complete.
<p><a NAME="winnt-run"></a>
<h3>
How to run applications</h3>
You can now refer to the file 'ensemble\doc\tut.ps' for instructions on
executing the demo applications. This involves setting a few environment
variables and then executing the applications.
<p><a NAME="winnt-native"></a>
<h3>
Building the native code version for Windows NT</h3>
You can also compile everything to run on the native instruction set of
your computer instead of using an interpreter. This will run faster.
<p>To use the native code version of Ensemble, compile it in the directory
<b>ensemble\opt</b>.
This step compiles all of the Ensemble sources and will take awhile. This
is also where you build the native code versions of the HOT tools.&nbsp;
<b>*NOTE*</b> You must make sure that the Microsoft executables, masm.exe
and ml.exe are installed and in your path.
<p>In order to compile the HOT tools, you would do the following:
<pre>&nbsp;&nbsp;&nbsp; # build native code libraries in opt directory
&nbsp;&nbsp;&nbsp; # directory: ensemble\opt
&nbsp;&nbsp;&nbsp; nmake -f Makefile.nt
&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp; # change directory to demo and build native code demo programs&nbsp;
&nbsp;&nbsp;&nbsp; # directory: ensemble\demo
&nbsp;&nbsp;&nbsp; nmake -f Makefile.nt socketopt

&nbsp;&nbsp;&nbsp; # change back to opt and build the HOT tools
&nbsp;&nbsp;&nbsp; # directory: ensemble\opt
&nbsp;&nbsp;&nbsp; nmake -f Makefile.nt libhot</pre>
Once you have built the HOT tools, there will be 3 executable files placed
in the ensemble\demo directory: <b><i>hot_test.exe, hot_testo.exe</i></b>,
and <b><i>outboard.exe</i></b>. The file hot_test.exe runs basic single-process
sanity checks of the HOT C / Ensemble interface. The files hot_testo.exe
("o" is for outboard) and outboard.exe perform the same sanity checks,
however, the Ensemble protocols are isolated in a separate process (outboard.exe)
and communication takes place via TCP sockets.&nbsp; The hot library file,
<b><i>ensemble\lib\nt\libhot.a</i></b>
will&nbsp; be placed in the ensemble\lib\nt directory.&nbsp; You will need
to link this hot library with your own "C" applications.
<p>There is also an auxilliary HOT test program, called hot_test2.c, which
can be compiled as follows:
<pre>&nbsp;&nbsp;&nbsp; # build the hot_test2 demo program
&nbsp;&nbsp;&nbsp; # directory: ensemble\opt
&nbsp;&nbsp;&nbsp; nmake -f Makefile.nt hot_test2</pre>
This will build and install the program <b>hot_test2.exe</b> in the demo
directory.&nbsp; The program hot_test2 is a two-process RPC performance
test.
<p>In order to run hot_testo.exe, you <i>first </i>have to set environment
variables. This is done through the Control Panel, by selecting the System
icon, and then selecting the Environment tab. You then enter the environment
variable <b>ENS_OUTBOARD</b> and for its value, you enter the complete
path to the outboard.exe file, e.g.:
<p>ENS_OUTBOARD
<p>c:\ensemble\demo\outboard.exe
<p>Then select "Set" and "OK".&nbsp; The Environment data entry window
will close.&nbsp; You may now open a MS DOS Console window and run hot_testo.exe.
<p>If you attempt to run hot_testo.exe and you get the following output,
it means that you did not set the <b>ENS_OUTBOARD </b>environment variable
<b><i>before
</i></b>you
opened the Command prompt window (it needs to be set before the Command
prompt is opened in order to be exported):
<p>HOT_TEST: CDEMO: starting
<p>PANIC: spawnvp
<p>Close the Command prompt window, go to the Control Panel, open the System
icon, select Environment, add the <b>ENS_OUTBOARD </b>variable, then select
"Set", and "OK". Open a new Command prompt window and try again.
<p>The HOT tools can also be built with cryptographic support as follows.&nbsp;
First you will need to edit the file, <b><i>config.nmk,</i></b> and uncomment
the <b>CRYPTO_LINK</b> lines.&nbsp; Then perform the following at the command
line:
<pre>&nbsp;&nbsp;&nbsp; # build crypto library
&nbsp;&nbsp;&nbsp; # directory: ensemble\opt
&nbsp;&nbsp;&nbsp; nmake -f Makefile.nt crypto</pre>

<pre>&nbsp;&nbsp;&nbsp; # build HOT tools with crypto support
&nbsp;&nbsp;&nbsp; # directory: ensemble\opt
&nbsp;&nbsp;&nbsp; nmake -f Makefile.nt libhot-crypto</pre>
This will build versions of the hot_tests and outboard executables with
a "-crypto" extension and place them in the demo directory.
<p><a NAME="winnt-maestro"></a>
<h3>
Building the <a href="http://www.cs.cornell.edu/Info/Projects/Ensemble/Maestro/Maestro.html">Maestro</a>
tools for Windows NT</h3>
<b>** NOTE **&nbsp; </b>The Maestro IIOP software, built when compiling
on Unix, has not yet been ported to NT.
<br>You need to have compiled the HOT library before compiling the <a href="http://www.cs.cornell.edu/Info/Projects/Ensemble/Maestro/Maestro.html">Maestro</a>
C++ interface. This step generates the file <b><i>ensemble\maestro\maestro-nt\libmae-nt.lib</i></b>
as well as the maestro test programs:
<pre>&nbsp;&nbsp;&nbsp; # build the Maestro tools
&nbsp;&nbsp;&nbsp; # directory: ensemble\opt
&nbsp;&nbsp;&nbsp; nmake -f Makefile.nt maestro-nt</pre>
You should now have three test programs, <b><i>ensemble\maestro\maestro-nt\maestro_test.exe,
ensemble\maestro\maestro-nt\maestro_perf.exe, and ensemble\maestro\maestro-nt\group.exe</i></b>.&nbsp;
maestro_test is a single process sanity test in which several group-member
objects are created which then randomly send messages and leave/rejoin
the group.&nbsp; maestro_perf is a two-process RPC performance test.&nbsp;
group is an application which tests the <b>new, simpler</b> state transfer
algorithm. To get started with Maestro and Ensemble, we recommend you read
the <a href="http://www.cs.cornell.edu/Info/Projects/Ensemble/Maestro/Maestro.html">Maestro
documentation</a> and start from the test programs (in the corresponding
.C files) -- you can modify and experiment with them.
<p><a NAME="nt-java"></a>
<h3>
Building the EJava Interface for Windows NT</h3>
The EJava interface to Ensemble was built and tested using Sun Microsystem's
<b>JDK1.2</b>.&nbsp;
Before trying to build this interface, please check and make sure you have
access to JDK1.2.&nbsp; Then follow these steps:
<pre>&nbsp;&nbsp;&nbsp; # build the EJava interface
&nbsp;&nbsp;&nbsp; # directory: ensemble\ejava
&nbsp;&nbsp;&nbsp; nmake -f Makefile.nt</pre>
You can then run one of the demo programs, EnsDemoOutboard or ThreadTest
as follows:
<pre>&nbsp;&nbsp;&nbsp; java EnsDemoOutboard</pre>
EnsDemoOutboard is a graphical version of the mtalk demo.&nbsp; It allows
processes to "chat" to each other. The demo application, ThreadTest, is
a test which stresses multi-threading.&nbsp;&nbsp; It requires one parameter,
the number of group members to wait for before beginning the test.&nbsp;
For example, to run the test with 2 members, start the test on 2 machines
(or 2 consoles) as follows:
<pre>&nbsp;&nbsp;&nbsp; java ThreadTest 2</pre>

<pre><a NAME="nt-java"></a></pre>

<h3>
Installation is complete</h3>
This concludes the instructions for building Ensemble on Windows NT systems.
<br><a href="#installation">Back to installation guide.</a>
<hr><a NAME="unix-install"></a>
<h2>
Building Ensemble on Unix Systems</h2>
<b>** NOTE ** </b>This distribution of Ensemble requires users to build
the bytecode libraries - they are not supplied pre-compiled as with previous
distributions. Directions to do so are included below. Some demonstration
applications have been provided which you can use to test the distribution
once the first parts are installed.
<p>You can also compile everything to run on the native instruction set
of your computer instead of using an interpreter. This will run faster.
You can also use a special Socket library to improve the performance of
network operations. Details on how to build all of these things are given
below.
<p><a NAME="unix-demo"></a>
<h3>
Building on Unix Systems</h3>
First, make sure the <b>CAMLLIB</b> environment variable is set, and the
Ocaml binaries are accessible from your PATH.&nbsp; Then compile the Ensemble
system and demonstration programs as follows (on UNIX, the make automatically
builds the demo programs):
<pre>&nbsp;&nbsp;&nbsp;&nbsp; # make the Ensemble system
&nbsp;&nbsp;&nbsp;&nbsp; # directory: ensemble/def
&nbsp;&nbsp;&nbsp;&nbsp; make</pre>
If all went smoothly, the initial installation is now complete, and you
can try out the demo programs following the instructions below.
<p><a NAME="unix-run"></a>
<h3>
How to run applications</h3>
You can now refer to the tutorial, 'ensemble/doc/tut.ps', for instructions
on executing the demo applications. This involves setting a few environment
variables and then executing the applications. Come back to here to install
additional parts of Ensemble.
<p><a NAME="unix-tk"></a>
<h3>
Graphical Demos</h3>
<b>If you installed the O'caml Tcl/Tk interface</b>, compile the white
board demo and "Game of Life" demo. (Note: In order to use the Tcl/Tk interface
you may need to set the TKLIB macro in 'ensemble/mk/config.mk' and you
must have installed the camltk41 libraries).&nbsp; These applications will
not compile if the Ocaml TK interface has not been installed.
<pre>&nbsp;&nbsp;&nbsp;&nbsp; # make the Ensemble tk library
&nbsp;&nbsp;&nbsp;&nbsp; # directory: ensemble/def
&nbsp;&nbsp;&nbsp;&nbsp; make tk</pre>

<pre>&nbsp;&nbsp;&nbsp;&nbsp; # make the white board demo
&nbsp;&nbsp;&nbsp;&nbsp; # directory: ensemble/demo/tk
&nbsp;&nbsp;&nbsp;&nbsp; make

&nbsp;&nbsp;&nbsp;&nbsp; # make the game-of-life demo
&nbsp;&nbsp;&nbsp;&nbsp; # directory: ensemble/demo/life
&nbsp;&nbsp;&nbsp;&nbsp; make</pre>
<a NAME="unix-env"></a>
<h3>
Environment variables</h3>
In order to compile platform-dependent parts (the Socket library, the native
code, the HOT C interface, and the Maestro C++ interface) some configuration
needs to be done.
<ul>
<li>
If you are running on a system where the environment variables <b>MACHTYPE
</b>and
<b>OSTYPE</b>
are not automatically defined then you should set these to appropriate
values for your platform. These environment variables are only used in
naming files and do not affect compilation. To be compatible with naming
of the platform-dependent libraries we distribute, you should use values
such as these:</li>
</ul>

<ul>
<li>
<b>MACHTYPE : sparc, i386, rs6000, alpha,</b> ...</li>

<li>
<b>OSTYPE : sunos4, solaris, aix, linux, osf1, ...</b></li>
</ul>
In sh, you set them like this:
<ul>
<ul>
<pre>&nbsp;&nbsp;&nbsp; MACHTYPE=i386
&nbsp;&nbsp;&nbsp; export MACHTYPE
&nbsp;&nbsp;&nbsp; OSTYPE=linux
&nbsp;&nbsp;&nbsp; export OSTYPE</pre>
</ul>

<li>
Make sure the Ocaml binaries are in your <b>PATH</b>.</li>
</ul>

<ul>
<li>
Set the <b>CAMLLIB</b> environment variable to the directory where you
installed the O'Caml libraries. O'Caml will give you the correct value
for this if you type:</li>

<pre>&nbsp;&nbsp;&nbsp; % ocamlc -v
&nbsp;&nbsp;&nbsp; The Objective Caml compiler, version 3.00
&nbsp;&nbsp;&nbsp; Standard library directory: /usr/local/lib/ocaml</pre>
The second line printed out by this is the location where O'Caml installed
the libraries. In sh, you set the CAMLLIB variable like this:
<pre>&nbsp;&nbsp;&nbsp; CAMLLIB=/usr/local/lib/ocaml
&nbsp;&nbsp;&nbsp; export CAMLLIB</pre>
</ul>
In tcsh, set them like this:
<pre>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; setenv CAMLLIB /usr/local/lib/ocaml
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; setenv PATH /usr/local/bin/ocaml:$PATH</pre>
We recommend you add these to your '.profile' or equivalent for your shell.
<p><a NAME="unix-socket"></a>
<h3>
Building the Socket library</h3>
The Socket library supports extensions to the Unix library concerned with
communication. It is derived in large part from the O'Caml Unix library.
It is not necessary on Unix (the O'Caml Unix library is used by default),
but using the Socket library increases Ensemble performance and decreases
memory usage. Note that you only need to compile this separately if you
are using the bytecode version of Ensemble. The build for the native code
system compiles the Socket library by default.
<pre>&nbsp;&nbsp;&nbsp; # In ensemble/mk/config.mk, edit the macro definition for HSYS_TYPE to be "skt".
&nbsp;&nbsp;&nbsp; # directory: ensemble/def
&nbsp;&nbsp;&nbsp; make socket</pre>

<pre>&nbsp;&nbsp;&nbsp; # directory: ensemble/def
&nbsp;&nbsp;&nbsp; make clean; make</pre>
When you compile other parts of Ensemble in the future, the Socket library
will be used in place of the Unix library.
<p><a NAME="unix-hot"></a>
<h3>
Building the HOT tools</h3>
The HOT tools can be compiled from either the bytecode or native code version
of Ensemble. Compiling from 'ensemble/def' builds the bytecode version.
Compiling from 'ensemble/opt' builds the native version. Either way the
C library file that is generated is platform dependent.
<p>This step generates the file '<b><i>ensemble/lib/PLATFORM/libhot.a</i></b>'
(where PLATFORM is the name of your platform) and installs the HOT library
files into 'ensemble/lib/PLATFORM'.
<p><b>**NOTE ** </b>For users on SunOS, lacking Solaris threads,&nbsp;
please contact us for a thread package to use (the rvr_threads package).&nbsp;
Alternatively, please see the section below on POSIX threads.&nbsp; You
will have to obtain this threads package, install it, and modify the ensemble/mk/config.mk
file to reference the corresponding threads interface file (either ensemble/hot/rvr_intf.c
or pthread_intf.c).
<pre>&nbsp;&nbsp;&nbsp; # build the HOT tools
&nbsp;&nbsp;&nbsp; # directory: ensemble/def (or ensemble/opt)
&nbsp;&nbsp;&nbsp; make libhot</pre>
There is also an auxilliary HOT test program, called hot_test2.c, which
can be compiled as follows:
<pre>&nbsp;&nbsp;&nbsp; # build the hot_test2 demo program
&nbsp;&nbsp;&nbsp; # directory: ensemble/def
&nbsp;&nbsp;&nbsp; make hot_test2</pre>
This will build and install the program <b>hot_test2</b> in the demo directory.&nbsp;
The program hot_test2 is a two-process RPC performance test.
<br>The HOT tools can also be built with cryptographic support as follows.&nbsp;
First you will need to edit the file, <b><i>config.mk,</i></b> and uncomment
the <b>CRYPTO_LINK</b> lines.&nbsp; Then perform the following at the command
line:
<pre>&nbsp;&nbsp;&nbsp; # build the HOT tools with crypto
&nbsp;&nbsp;&nbsp; # directory: ensemble/def (or ensemble/opt)
&nbsp;&nbsp;&nbsp; make libhot-crypto</pre>
This will install the hot_test-crypto, hot_testo-crypto and outboard-crypto
files in the demo directory.
<p><a NAME="unix-maestro"></a>
<h3>
Building the <a href="http://www.cs.cornell.edu/Info/Projects/Ensemble/Maestro/Maestro.html">Maestro</a>
tools</h3>
You need to have compiled the HOT library before compiling the <a href="http://www.cs.cornell.edu/Info/Projects/Ensemble/Maestro/Maestro.html">Maestro</a>
C++ interface. You need a C++ compiler in order to compile Maestro. This
step generates the file '<b><i>ensemble/maestro/conf/PLATFORM/libmae.a</i></b>'
(where platform is the name of your platform).
<pre>&nbsp;&nbsp;&nbsp; # build the Maestro and IIOP libraries and utilities
&nbsp;&nbsp;&nbsp; # directory: ensemble/def&nbsp;
&nbsp;&nbsp;&nbsp; make maestro</pre>

<pre>&nbsp;&nbsp;&nbsp; # build the Maestro and IIOP test applications
&nbsp;&nbsp;&nbsp; # directory: ensemble/def&nbsp;
&nbsp;&nbsp;&nbsp; make maestro_test</pre>
(** NOTE ** You can also run "make" in the maestro directory)
<p>You should now have five test programs, <b><i>ensemble/maestro/test/maestro-test
,</i></b> <b><i>ensemble/maestro/test/maestro-perf,&nbsp; ensemble/maestro/test/test-replicated</i></b>,
<b><i>ensemble/maestro/test/test-simple,
and ensemble/maestro/test/group</i></b>.&nbsp; maestro-test is a single
process sanity test in which several group-member objects are created which
then randomly send messages and leave/rejoin the group.&nbsp; maestro-perf
is a two-process RPC performance test.&nbsp; Both test-replicated and test-simple
are Maestro IIOP test applications. group is an application which tests
the <b>new, simpler </b>state transfer algorithm. See ensemble/maestro/REF.ps
for more information on the Maestro IIOP tools. To get started with Maestro
and Ensemble, we also recommend you read the <a href="http://www.cs.cornell.edu/Info/Projects/Ensemble/Maestro/Maestro.html">Maestro
documentation</a> and start from the test programs (in the corresponding
.C files) -- you can modify and experiment with them.
<pre><a NAME="unix-native"></a></pre>

<h3>
Building the native code version</h3>
To use the native code version of Ensemble, compile it in the directory
'ensemble/opt'. This is also where you build the native code versions of
the HOT tools. Note that this automatically compiles the native code Socket
library for you. This step compiles all of the Ensemble sources (including
the demos) and will take awhile.
<pre>&nbsp;&nbsp;&nbsp; # build native code libraries
&nbsp;&nbsp;&nbsp; # directory: ensemble/opt
&nbsp;&nbsp;&nbsp; make

&nbsp;&nbsp;&nbsp; # build the HOT tools for native code
&nbsp;&nbsp;&nbsp; # directory: ensemble/opt
&nbsp;&nbsp;&nbsp; make libhot

&nbsp;&nbsp;&nbsp; # build the Maestro and IIOP libraries and utilities
&nbsp;&nbsp;&nbsp; # directory: ensemble/opt&nbsp;
&nbsp;&nbsp;&nbsp; make maestro</pre>

<pre>&nbsp;&nbsp;&nbsp; # build the Maestro and IIOP test applications
&nbsp;&nbsp;&nbsp; # directory: ensemble/opt&nbsp;
&nbsp;&nbsp;&nbsp; make maestro_test</pre>

<h3>
<a NAME="unix-java"></a></h3>

<h3>
Building the EJava Interface</h3>
The EJava interface to Ensemble was built and tested using Sun Microsystem's
<b>JDK1.2</b>.&nbsp;
Before trying to build this interface, please check and make sure you have
access to JDK1.2.&nbsp; Then follow these steps:
<pre>&nbsp;&nbsp;&nbsp; # build the EJava interface
&nbsp;&nbsp;&nbsp; # directory: ensemble/ejava
&nbsp;&nbsp;&nbsp; make</pre>
You can then run one of the demo programs,&nbsp; EnsDemoOutboard or ThreadTest
as follows:
<pre>&nbsp;&nbsp;&nbsp; java EnsDemoOutboard</pre>
EnsDemoOutboard is a graphical version of the mtalk demo.&nbsp; It allows
processes to "chat" to each other. The demo application, ThreadTest, is
a test which stresses multi-threading.&nbsp; ThreadTest, requires one parameter,
the number of group members to wait for before beginning the test.&nbsp;
For example, to run the test with 2 members, start the test on 2 machines
(or 2 consoles) as follows:
<pre>&nbsp;&nbsp;&nbsp; java ThreadTest 2</pre>
<a NAME="nt-java"></a>
<h3>
Installation is complete</h3>
This concludes the instructions for building Ensemble on Unix systems.
<br><a href="#installation">Back to installation guide.</a>
<p>
<hr>
<h2>
"Contrib" Code Removed,&nbsp; Packaged Separately</h2>
With Ensemble version 0.70p1, we only include the Ensemble core toolkit.&nbsp;
All other contributed work will be available separately by request.&nbsp;
Separate tar (or zip) files will be generated for the add-on work, including&nbsp;
the <b>Dynamic Virtual Private Network (DVPN)</b> code, the <b>rvr_threads
</b>package,
and a related project <b>JavaGroups . 
</b>These add-ons will be available
upon request.
<br>&nbsp;
<h2>
Java Interface Updated</h2>
Due to popular demand, the Ensemble Java interface, Ejava, is now included
in the core Ensemble release.&nbsp; The interface and demo programs can
be found in the ensemble/ejava directory.&nbsp; The ejava interface has
been updated with new functions to allow it to inter-operate with HOT "C"/Maestro
applications.&nbsp; See the RELEASE_NOTES for more information.
<p><b><font size=+1>NOTE: </font></b>This Java interface was developed
using&nbsp; <b>Sun Microsystem's JDK 1.2.&nbsp;</b> Other versions of Java
or earlier versions of the JDK may not work properly.
<p>
<hr><a NAME="multiple-platforms"></a>
<h2>
Building Ensemble on Multiple Platforms</h2>
Multiple versions of Ensemble can co-exist within the same directory tree.
All platform-dependent files now have a separate directory describing the
platform for which they were compiled. For Unix platforms, you just need
to ensure that the 'MACHTYPE' and 'OSTYPE' environment variables are correctly
set. For Windows NT, the name of the platfrom ('nt') is embedded in the
Windows NT makefiles and does not need to be set. For instance, the platform-independent
bytecode library for Ensemble is called 'libens.cma' ('cma' is the O'Caml
suffix used for bytecode libraryies). The platform-dependent, native code
library for Ensemble on i386, Linux platforms is called '<b><i>lib/i386-linux/libens.cmxa</i></b>'
('cmxa' is the O'Caml suffix for native code libraries').
<p>The only exceptions are the demo programs. These are platform independent
but do not follow the naming convention. Whenever you compile executables
for a new platform, the old executable demos are removed and replaced with
the new ones.
<p>This concludes the instructions for building Ensemble on multiple platforms.
<br><a href="#installation">Back to installation guide.</a>
<br>&nbsp;
<h2>
"Make Clean" Changes for Removing Object Files/Executables</h2>
Since the directory tree has changed to accomodate platform-specific builds,
the behavior of the Make command, "<b>make clean</b>" (or "nmake -f Makefile.nt
clean" on NT) has changed as well.&nbsp; Now, "make clean" from the top-level
directory (ensemble) will call "make clean" in each of the <b>def </b>and
<b>opt</b>
directories.&nbsp; "make clean" in each of these directories will remove
the <b><i>platform-specific</i></b> object code directories, e.g. <b><i>def/obj/sparc-solaris,
</i></b>as
well as the platform-specific library files, e.g: <b><i>ensemble/lib/sparc-solaris,
</i></b>the
compiled demo programs, and the compiled platform-specific maestro files,
e.g.<b><i> ensemble/maestro/conf/sparc-solaris.</i></b>
<p>The command "<b>make realclean</b>"&nbsp; will&nbsp; attempt to perform
the "make clean" operations <b>ON ALL PLATFORMS, </b>e.g. sparc-solaris,
linux, and NT, and so is to be used only when cleaning up the entire distribution
directory of ALL compiled object files and executables.
<p>
<hr><a NAME="fsu-threads"></a>
<h2>
POSIX threads</h2>
If your system does not have a native POSIX threads library, install the
FSU pthreads.tar.gz package. You can get it from:
<ul>
<li>
<a href="http://www.cs.fsu.edu/~mueller/pthreads/">http://www.cs.fsu.edu/~mueller/pthreads/
</a>(USA)</li>

<li>
<a href="http://www.informatik.hu-berlin.de/~mueller/pthreads/">http://www.informatik.hu-berlin.de/~mueller/pthreads/</a>
(Europe)</li>
</ul>
After installing the library. Update in ensemble/mk/config the macros GTHREADS,
GTHREADS_INC to point to your installation. If necessary, add new HOT_CFLAGS_arch_os,
HOT_MLLINK_arch_os, HOT_LINK_arch_os, and HOT_THREAD_OBJ_arch_os macros
to config.mk for your platform (and send them to us so we can add them
to the next distribution).
<br><a href="#installation">Back to installation guide.</a>
<p><a NAME="fsu-threads"></a>
<br>
<hr>
<h2>
SECURITY</h2>
Ensemble version 0.70p1 supports several security properties, including user
message encryption, authentication, and group member authorization. In
order to make ensemble with cryptographic support,&nbsp; <b>FIRST, you
must edit config.mk.</b>&nbsp; You will see the CRYPTO_LINK define commented
out by default.&nbsp; Comment out the top (empty) CRYPTO_LINK line and
uncomment the next 3 CRYPTO_LINK lines.&nbsp; On NT, simply uncomment the
lines following the CRYPTO_LINK line.&nbsp; This will now link in the crypto
libraries when you build executables.&nbsp; Now perform the following steps:
<p>(**<b> NOTE:</b>&nbsp; This version of the security code requires <b>PGP5.0
</b>on
Unix.)
<p>Unix:
<pre>&nbsp;&nbsp;&nbsp; # Make the regular crypto library
&nbsp;&nbsp;&nbsp; # directory: ensemble/def
&nbsp;&nbsp;&nbsp; make crypto

&nbsp;&nbsp;&nbsp; # Make the demo's with the crypto library
&nbsp;&nbsp;&nbsp; # directory: ensemble/def
&nbsp;&nbsp;&nbsp; make

&nbsp;&nbsp;&nbsp; # Make the optimized crypto library
&nbsp;&nbsp;&nbsp; # directory: ensemble/opt
&nbsp;&nbsp;&nbsp; make crypto</pre>

<pre>&nbsp;&nbsp;&nbsp; # Make the demo's with the optimized crypto library
&nbsp;&nbsp;&nbsp; # directory: ensemble/opt
&nbsp;&nbsp;&nbsp; make

&nbsp;&nbsp;&nbsp; # Make libhot with the optmized crypto library
&nbsp;&nbsp;&nbsp; # directory: ensemble/opt
&nbsp;&nbsp;&nbsp; make libhot-crypto</pre>

After following the above steps, to build maestro test applications with crypto
support, edit the file:
<pre>ensemble/maestro/test/Makefile</pre>
and uncomment out the crypto versions of CRYPTOLIB and HOTLIB, commenting out the default versions, 
e.g:

<pre>
#HOTLIB		= $(ENS)/lib/$(PLATFORM)/libhot.a
HOTLIB		= $(ENS)/lib/$(PLATFORM)/libhot-crypto.a

#CRYPTOLIB	=
CRYPTOLIB	= $(ENS)/lib/$(PLATFORM)/libcryptoc.a
</pre>

Then:

<pre>
&nbsp;&nbsp;&nbsp; # Make maestro with the crypto library
&nbsp;&nbsp;&nbsp; # directory: ensemble/def or opt
&nbsp;&nbsp;&nbsp; make maestro_test</pre>

<pre>**<b> NOTE:</b>&nbsp; on NT, change "make" to:</pre>

<pre>nmake -f Makefile.nt</pre>
and things should compile smoothly.
<br>&nbsp;
<p><a href="#installation">Back to installation guide.</a>
</body>
</html>
